# Example environment configuration
# Copy this file to .env and adjust values for your environment.

# PostgreSQL Configuration
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=open-mercato
POSTGRES_PORT=5432

# PostgreSQL connection string (required)
DATABASE_URL=postgres://postgres:postgres@localhost:5432/open-mercato

# JWT secret for auth tokens (required)
JWT_SECRET=change-me-dev-secret

# Events transport (choose one)
# REDIS_URL=redis://localhost:6379
# or
# EVENTS_REDIS_URL=redis://localhost:6379

# Email provider (optional)
# RESEND_API_KEY=

# Public URL used in emails and onboarding flows
APP_URL=http://localhost:3000

# Enable self-service onboarding (default: false)
SELF_SERVICE_ONBOARDING_ENABLED=false
DEMO_MODE=true

# Admin email to notify about onboarding submissions
ADMIN_EMAIL=ops@your-domain.com

# Node environment
NODE_ENV=development

# Hybrid query engine SQL logging (optional, default: false)
# Set to true to log raw SQL statements from the hybrid query engine.
QUERY_ENGINE_DEBUG_SQL=false

# Enable tree profiler for matching resources/entities (comma-separated filters, e.g. * - for all profilers,customers.*, customers.people)
# OM_PROFILE=
# Enable detailed CRUD profiling for matching resources (comma-separated filters, e.g. customers.*, *)
# OM_CRUD_PROFILE=
# Enable hybrid query engine profiling for matching entities (comma-separated filters, e.g. customers.*, customers.people)
# OM_QE_PROFILE=

# Enable cache for CRUD API responses (default: false)
ENABLE_CRUD_API_CACHE=false

# Auto-reindex query indexes when coverage gaps are detected (default: true)
SCHEDULE_AUTO_REINDEX=true

# Skip immediate coverage recalculation on read (default: false)
OPTIMIZE_INDEX_COVERAGE_STATS=false

# Continue serving results from entity indexes when coverage gaps are detected (default: true)
FORCE_QUERY_INDEX_ON_PARTIAL_INDEXES=true

# Toggle EAV backward compatibility for user-defined entities (custom field values)
# When true, DataEngine will also write to custom_field_values on create/update of custom entities.
# Default is false: values are only stored in custom_entities_storage.
ENTITIES_BACKCOMPAT_EAV_FOR_CUSTOM=false

# Cache strategy (default: memory)
CACHE_STRATEGY=sqlite

# Default TTL in milliseconds (optional)
CACHE_TTL=300000

# Redis Configuration
#REDIS_PORT=6379

# Redis configuration (for redis strategy)
#CACHE_REDIS_URL=redis://localhost:6379

# SQLite configuration (for sqlite strategy)
CACHE_SQLITE_PATH=./data/cache.db

# JSON file configuration (for jsonfile strategy)
#CACHE_JSON_FILE_PATH=./data/cache.json

# Database pooling settings
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_ACQUIRE_TIMEOUT=60000

# Audit log retention windows
# Core resources (users, roles) keep access history longer to support investigations.
AUDIT_LOGS_CORE_RETENTION_DAYS=7
# Non-core reads rotate aggressively to limit storage.
AUDIT_LOGS_NON_CORE_RETENTION_HOURS=8
